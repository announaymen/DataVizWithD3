{"version":3,"sources":["StackedBarGraph.js","BarGraph.js","App.js","index.js"],"names":["StackedBarGraph","_ref","datasets","keys","colors","_useState","useState","_useState2","Object","slicedToArray","data","setData","svgRef","useRef","wrapperRef","useEffect","svg","select","current","_wrapperRef$current$g","getBoundingClientRect","width","height","layers","stack","stackGenerator","extent","max","layer","sequence","yScale","scaleLinear","domain","range","x0Scale","scaleBand","map","d","name","padding","x1Scale","type","rangeRound","bandwidth","tooltip","append","style","html","xAix","axisBottom","yAix","axisLeft","attr","concat","call","selectAll","join","key","on","console","log","event","pageY","pageX","e","filteredD","Affiliate","Social","Media","react_default","a","createElement","Fragment","ref","marginBottom","className","allKeys","D3BarGraph","setKeys","StackedBarGraph_StackedBarGraph","display","id","checked","includes","onChange","target","Array","from","Set","toConsumableArray","filter","_key","htmlFor","color","App","BarGraph_D3BarGraph","rootElement","document","getElementById","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.48771d08.chunk.js","sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\nimport {\n  select,\n  scaleBand,\n  axisBottom,\n  axisLeft,\n  scaleLinear,\n  stack,\n  max,\n  event,\n} from \"d3\";\n\nexport const StackedBarGraph = ({ datasets, keys, colors }) => {\n  const [data, setData] = useState(datasets);\n  const svgRef = useRef();\n  const wrapperRef = useRef();\n\n  useEffect(() => {\n    const svg = select(svgRef.current);\n    const { width, height } = wrapperRef.current.getBoundingClientRect();\n    const stackGenerator = stack().keys(keys);\n    const layers = stackGenerator(data);\n    const extent = [\n      0,\n      max(layers, (layer) => max(layer, (sequence) => sequence[1])),\n    ];\n    const yScale = scaleLinear().domain(extent).range([height, 0]);\n\n    const x0Scale = scaleBand()\n      .domain(data.map((d) => d.name))\n      .range([0, width])\n      .padding(0.46);\n    const x1Scale = scaleBand()\n      .domain(data.map((d) => d.type))\n      .rangeRound([0, x0Scale.bandwidth()])\n      .padding(0.12);\n\n    const tooltip = select(svgRef.current)\n      .append(\"div\")\n      .style(\"position\", \"absolute\")\n      .style(\"visibility\", \"visible\")\n      .style(\"background-color\", \"black\")\n      .style(\"border\", \"solid\")\n      .style(\"border-width\", \"1px\")\n      .style(\"border-radius\", \"5px\")\n      .style(\"padding\", \"10px\")\n      .html(\"<p>I'm a tooltip written in HTML</p>\");\n\n    const xAix = axisBottom(x0Scale);\n    const yAix = axisLeft(yScale);\n\n    svg\n      .select(\".x-axis\")\n      .attr(\"transform\", `translate(0, ${height})`)\n      .call(xAix);\n    svg\n      .select(\".y-axis\")\n      .attr(\"transform\", `translate(${0 + 25}, 0 )`)\n      .call(yAix);\n\n    svg\n      .selectAll(\".layer\")\n      .data(layers)\n      .join(\"g\")\n      .attr(\"class\", \"layer\")\n      .attr(\"fill\", (layer) => colors[layer.key])\n      .selectAll(\"rect\")\n      .data((layer) => layer)\n      .join(\"rect\")\n      .attr(\"class\", \"barreact\")\n      .attr(\n        \"x\",\n        (sequence) => x0Scale(sequence.data.name) + x1Scale(sequence.data.type)\n      )\n      .attr(\"width\", x1Scale.bandwidth())\n      .attr(\"y\", (sequence) => yScale(sequence[1]))\n      .attr(\"height\", (sequence) => yScale(sequence[0]) - yScale(sequence[1]));\n\n    svg\n      .select(\".barreact\")\n      .on(\"mouseover\", function () {\n        console.log(\"event.pageY  \", event.pageY);\n        return tooltip.style(\"visibility\", \"visible\");\n      })\n      .on(\"mousemove\", function () {\n        return tooltip\n          .style(\"top\", event.pageY + \"px\")\n          .style(\"left\", event.pageX + \"px\");\n      })\n      .on(\"mouseout\", function () {\n        return tooltip.style(\"visibility\", \"hidden\");\n      });\n\n    svg\n      .select(\".x-axis\")\n      .selectAll(\".tick\")\n      .on(\"click\", (e) => {\n        const filteredD = data.map((d) => {\n          return {\n            name: d.name,\n            Affiliate: d.name === e ? null : d.Affiliate,\n            Social: d.name === e ? null : d.Social,\n            Media: d.name === e ? null : d.Media,\n          };\n        });\n        setData(filteredD);\n      });\n  }, [data, keys, colors]);\n\n  return (\n    <>\n      <div\n        ref={wrapperRef}\n        style={{ width: \"100%\", height: \"400px\", marginBottom: \"2rem\" }}\n      >\n        <svg ref={svgRef} style={{ width: \"100%\", height: \"110%\" }}>\n          <g className=\"x-axis\" />\n          <g className=\"y-axis\" />\n        </svg>\n      </div>\n    </>\n  );\n};\n","import React, { useState } from \"react\";\nimport { StackedBarGraph } from \"./StackedBarGraph\";\n\nconst data = [\n  {\n    name: \"Etudiant\",\n    type: 1,\n    Affiliate: 10,\n    Social: 20,\n    Media: 30,\n  },\n  {\n    name: \"Etudiant\",\n    type: 2,\n    Affiliate: 20,\n    Social: 40,\n    Media: 60,\n  },\n  {\n    name: \"Brand 2\",\n    type: 1,\n    Affiliate: 30,\n    Social: 45,\n    Media: 80,\n  },\n  {\n    name: \"Brand 2\",\n    type: 2,\n    Affiliate: 40,\n    Social: 60,\n    Media: 100,\n  },\n  {\n    name: \"Brand 3\",\n    type: 1,\n    Affiliate: 50,\n    Social: 80,\n    Media: 120,\n  },\n  {\n    name: \"Brand 3\",\n    type: 2,\n    Affiliate: 60,\n    Social: 90,\n    Media: 150,\n  },\n];\n\nconst allKeys = [\"Affiliate\", \"Social\", \"Media\"];\n\nconst colors = {\n  Affiliate: \"rgba(69, 0, 0, 0.8)\",\n  Social: \"rgba(240, 72, 19, 0.8)\",\n  Media: \"rgba(255, 199, 128, 0.8)\",\n};\n\nexport const D3BarGraph = () => {\n  const [keys, setKeys] = useState(allKeys);\n\n  return (\n    <div>\n      <StackedBarGraph datasets={data} colors={colors} keys={keys} />\n      <div className=\"fields\" style={{ display: \"flex\" }}>\n        {allKeys.map((key) => (\n          <div key={key} className=\"field\" style={{ display: \"flex\" }}>\n            <input\n              id={key}\n              type=\"checkbox\"\n              checked={keys.includes(key)}\n              onChange={(e) => {\n                if (e.target.checked) {\n                  setKeys(Array.from(new Set([...keys, key])));\n                } else {\n                  setKeys(keys.filter((_key) => _key !== key));\n                }\n              }}\n            />\n            <label htmlFor={key} style={{ color: colors[key] }}>\n              {key}\n            </label>\n          </div>\n        ))}\n      </div>\n    </div>\n  );\n};\n","import React from \"react\";\nimport { D3BarGraph } from \"./BarGraph\";\nimport \"./styles.css\";\n\nexport default function App() {\n  return (\n    <div className=\"App\">\n      <h1>TP INFOVIZ</h1>\n      <D3BarGraph />\n    </div>\n  );\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\n\nimport App from \"./App\";\n\nconst rootElement = document.getElementById(\"root\");\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  rootElement\n);\n"],"sourceRoot":""}